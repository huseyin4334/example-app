<!DOCTYPE html>
<div class="transports-container">
  <div class="header">
    <h1>Ula≈üƒ±m Y√∂netimi</h1>
  </div>

  <!-- Loading Spinner -->
  <div class="loading-spinner" *ngIf="loading">
    <div class="spinner"></div>
    <p>Y√ºkleniyor...</p>
  </div>

  <div class="content" [class.loading]="loading">
    <!-- Arama B√∂l√ºm√º -->
    <div class="search-section">
      <div class="search-group">
        <input 
          type="text" 
          [(ngModel)]="searchTerm" 
          placeholder="Ula≈üƒ±m bilgisi ara..."
          class="search-input"
          (keyup.enter)="onSearch()">
        <button class="btn btn-primary" (click)="onSearch()">Ara</button>
        <button class="btn btn-secondary" (click)="searchTerm = ''; onSearch()">Temizle</button>
      </div>
    </div>

    <!-- Yeni Ula≈üƒ±m Bilgisi Ekleme Formu -->
    <div class="form-section" *ngIf="!isEditing">
      <h2>Yeni Ula≈üƒ±m Bilgisi Ekle</h2>
      <div class="form-row">
        <div class="form-group">
          <label for="new-origin">Ba≈ülangƒ±√ß Lokasyonu:</label>
          <select
            id="new-origin"
            [(ngModel)]="newTransportation.origin"
            name="origin"
            class="form-control"
            required>
            <option value="">Lokasyon se√ßin</option>
            <option *ngFor="let location of locations" [value]="location.id">
              {{location.name}}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="new-destination">Varƒ±≈ü Lokasyonu:</label>
          <select
            id="new-destination"
            [(ngModel)]="newTransportation.destination"
            name="destination"
            class="form-control"
            required>
            <option value="">Lokasyon se√ßin</option>
            <option *ngFor="let location of locations" [value]="location.id">
              {{location.name}}
            </option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="new-transport-type">Ula≈üƒ±m T√ºr√º:</label>
          <select
            id="new-transport-type"
            [(ngModel)]="newTransportation.transportationType"
            name="transportationType"
            class="form-control"
            required>
            <option value="0">Ula≈üƒ±m t√ºr√º se√ßin</option>
            <option *ngFor="let type of transportationTypes" [value]="type.id">
              {{type.name}}
            </option>
          </select>
        </div>
        <div class="form-group">
          <label>Ge√ßerli G√ºnler:</label>
          <div class="days-selection">
            <div *ngFor="let day of days" class="day-checkbox">
              <input
                type="checkbox"
                [id]="'new-day-' + day"
                [checked]="isDaySelected(day)"
                (change)="onDayChange(day, $event)">
              <label [for]="'new-day-' + day">{{getDayLabel(day)}}</label>
            </div>
          </div>
        </div>
      </div>
      
      <button 
        class="btn btn-primary" 
        (click)="createTransportation()"
        [disabled]="!isValidTransportation(newTransportation) || loading">
        <span *ngIf="loading">Ekleniyor...</span>
        <span *ngIf="!loading">Ula≈üƒ±m Bilgisi Ekle</span>
      </button>
    </div>

    <!-- Ula≈üƒ±m Bilgisi D√ºzenleme Formu -->
    <div class="form-section" *ngIf="isEditing && selectedTransportation">
      <h2>Ula≈üƒ±m Bilgisi D√ºzenle</h2>
      <div class="form-row">
        <div class="form-group">
          <label for="edit-origin">Ba≈ülangƒ±√ß Lokasyonu:</label>
          <select
            id="edit-origin"
            [(ngModel)]="selectedTransportation.origin"
            name="origin"
            class="form-control"
            required>
            <option value="">Lokasyon se√ßin</option>
            <option *ngFor="let location of locations" [value]="location.id">
              {{location.name}} ({{location.city}}, {{location.country}})
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="edit-destination">Varƒ±≈ü Lokasyonu:</label>
          <select
            id="edit-destination"
            [(ngModel)]="selectedTransportation.destination"
            name="destination"
            class="form-control"
            required>
            <option value="">Lokasyon se√ßin</option>
            <option *ngFor="let location of locations" [value]="location.id">
              {{location.name}} ({{location.city}}, {{location.country}})
            </option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="edit-transport-type">Ula≈üƒ±m T√ºr√º:</label>
          <select
            id="edit-transport-type"
            [(ngModel)]="selectedTransportation.transportationType"
            name="transportationType"
            class="form-control"
            required>
            <option value="0">Ula≈üƒ±m t√ºr√º se√ßin</option>
            <option *ngFor="let type of transportationTypes" [value]="type.id">
              {{type.name}}
            </option>
          </select>
        </div>
        <div class="form-group">
          <label>Ge√ßerli G√ºnler:</label>
          <div class="days-selection">
            <div *ngFor="let day of days" class="day-checkbox">
              <input
                type="checkbox"
                [id]="'edit-day-' + day"
                [checked]="isDaySelected(day)"
                (change)="onDayChange(day, $event)">
              <label [for]="'edit-day-' + day">{{getDayLabel(day)}}</label>
            </div>
          </div>
        </div>
      </div>
      
      <div class="button-group">
        <button 
          class="btn btn-success" 
          (click)="updateTransportation()"
          [disabled]="!isValidTransportation(selectedTransportation) || loading">
          <span *ngIf="loading">G√ºncelleniyor...</span>
          <span *ngIf="!loading">G√ºncelle</span>
        </button>
        <button class="btn btn-secondary" (click)="cancelEdit()" [disabled]="loading">ƒ∞ptal</button>
      </div>
    </div>

    <!-- Ula≈üƒ±m Bilgileri Listesi -->
    <div class="list-section">
      <div class="list-header">
        <h2>Mevcut Ula≈üƒ±m Bilgileri</h2>
        <div class="list-info" *ngIf="totalItems > 0">
          <p>Toplam {{totalItems}} ula≈üƒ±m bilgisi bulundu</p>
        </div>
      </div>

      <div class="transportations-table" *ngIf="transportations.length > 0">
        <table class="table">
          <thead>
            <tr>
              <th>Ba≈ülangƒ±√ß</th>
              <th>Varƒ±≈ü</th>
              <th>Ula≈üƒ±m T√ºr√º</th>
              <th>Ge√ßerli G√ºnler</th>
              <th>ƒ∞≈ülemler</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let transportation of transportations" class="transportation-row">
              <td>
                <div class="location-name">
                  <strong>{{transportation.origin.name}}</strong>
                </div>
              </td>
              <td>
                <div class="location-name">
                  <strong>{{transportation.destination.name}}</strong>
                </div>
              </td>
              <td>
                <span class="transport-type">{{getTransportTypeLabel(transportation.transportType)}}</span>
              </td>
              <td>
                <div class="days-list">
                  <span *ngFor="let day of transportation.availableDays" class="day-tag">
                    {{getDayLabel(day)}}
                  </span>
                </div>
              </td>
              <td>
                <div class="action-buttons">
                  <button 
                    class="btn btn-sm btn-outline" 
                    (click)="selectTransportation(transportation)"
                    [disabled]="loading"
                    title="D√ºzenle">
                    ‚úèÔ∏è
                  </button>
                  <button 
                    class="btn btn-sm btn-danger" 
                    (click)="deleteTransportation(transportation.id)"
                    [disabled]="loading"
                    title="Sil">
                    üóëÔ∏è
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div class="pagination" *ngIf="totalPages > 1">
        <button 
          class="btn btn-pagination" 
          (click)="onPageChange(0)" 
          [disabled]="currentPage === 0 || loading">
          ƒ∞lk
        </button>
        <button 
          class="btn btn-pagination" 
          (click)="onPageChange(currentPage - 1)" 
          [disabled]="currentPage === 0 || loading">
          √ñnceki
        </button>
        
        <button 
          *ngFor="let page of getPageNumbers()" 
          class="btn btn-pagination" 
          [class.active]="(page - 1) === currentPage"
          (click)="onPageChange(page - 1)"
          [disabled]="loading">
          {{page}}
        </button>
        
        <button 
          class="btn btn-pagination" 
          (click)="onPageChange(currentPage + 1)" 
          [disabled]="currentPage === (totalPages - 1) || loading">
          Sonraki
        </button>
        <button 
          class="btn btn-pagination" 
          (click)="onPageChange(totalPages - 1)" 
          [disabled]="currentPage === (totalPages - 1) || loading">
          Son
        </button>
      </div>
      
      <div class="no-data" *ngIf="transportations.length === 0 && !loading">
        <p *ngIf="searchTerm">
          "<strong>{{searchTerm}}</strong>" aramasƒ± i√ßin sonu√ß bulunamadƒ±.
        </p>
        <p *ngIf="!searchTerm">
          Hen√ºz ula≈üƒ±m bilgisi bulunmuyor.
        </p>
      </div>
    </div>
  </div>
</div>
